Title: Capture Ratio and measurement overhead
URL: https://perfcap.blogspot.com/2005/03/capture-ratio-and-measurement-overhead.html

For performance monitoring applications, we often want to know the process related information, but collecting it from /proc is very expensive compared to collecting other performance data, and the amount of work increases as the number of processes increases.<br /><br />The <b>capture ratio</b> is defined as the amount of CPU time that is gathered by looking at process data versus the total systemwide CPU used. The difference is made up by processes that stop during the intervals between measurements. Since short lived processes may start and stop between measurements, and we don't know whether a process stopped immediately before a measurement or just after a measurement, there is always an error in sampled process measures. The error is reduced by using a short measurement interval, but that increases overhead. Bypassing the /proc interface, and reading process data directly from the kernel is very implementation dependent but is used by BMC's <a href=http://www.bmc.com>PATROL® for Unix - Perform & Predict</a> data collector, so that they can collect process data efficiently on large systems at high data rates.<br /><br />By watching traditional SysV accounting records that fall between measures, some heuristics can be used to improve the capture ratio. However the SysV accounting record does not include the process id, so this is an inexact technique. The <a href=http://www.teamquest.com>Teamquest® View and Model</a> data collector uses this trick.<br /><br />With extended accounting, we can use <b>wracct</b> to force a record of all current processes to be written to the accounting file, along with the processes that terminate. This gives us a perfect capture ratio, even at infrequent measurement intervals, so the overhead of process data collection is extremely low.<br /><br />There is no need for a performance collection agent, a cron script can invoke wracct at the desired measurement interval. Another cron script can use acctadm to switch logs to a new file and process locally or ship the old file to a central location as required.<br /><br />That in a nutshell is why extended accounting is interesting, very good quality data, perfect capture ratio and very low measurement overhead.